<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Explore Event Viewer</title>

  <!-- Favicon & Styles -->
  <link rel="icon" href="assets/images/cybersleuth-icon.png" type="image/png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/hidden.css" />
  <link rel="stylesheet" href="css/forensicsanalysis.css" />

</head>

<body class="lab-page">

  <!-- Header -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <div id="alertArea" class="container position-fixed top-0 start-50 translate-middle-x mt-3"
      style="z-index: 1055; max-width: 600px;"></div>

    <div class="container">
      <a class="navbar-brand d-flex align-items-center me-4" href="index.html" target="_blank">
        <img src="assets/images/cybersleuth-icon.png" alt="Logo" style="height: 22px;" class="me-2">
        CyberSleuth Academy
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
        aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="mainNavbar">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <li class="nav-item"><a href="home.html" class="nav-link">Dashboard</a></li>
          <li class="nav-item"><a href="learn.html" class="nav-link">Training Zone</a></li>
          <li class="nav-item"><a href="leaderboard.html" class="nav-link">Leaderboard</a></li>
          <li class="nav-item"><a href="quiz.html" class="nav-link">Knowledge Battle</a></li>
        </ul>
      </div>
    </div>
  </nav>

   <!-- Main Content -->
  <h2 style="text-align:center;">Event Viewer</h2>

  <div class="screenshot-container">
  <img src="assets/images/phishing/event_viewer.png" alt="Cybersecurity Screenshot" />
  <div class="hotspot-button" style="top: 33%; left: 4%; width: 10%; height: 4%;" onclick="openToolInfo('Application')"></div>
  <div class="hotspot-button" style="top: 37%; left: 4%; width: 10%; height: 4%;" onclick="openToolInfo('Security')"></div>
  <div class="hotspot-button" style="top: 44%; left: 4%; width: 10%; height: 4%;" onclick="openToolInfo('System')"></div>
  <div class="hotspot-button" style="top: 24%; left: 21.5%; width: 6.5%; height: 5%;" onclick="openToolInfo('Keywords')"></div>
  <div class="hotspot-button" style="top: 24%; left: 31%; width: 9%; height: 5%;" onclick="openToolInfo('Date and Time')"></div>
  <div class="hotspot-button" style="top: 24%; left: 50%; width: 5%; height: 5%;" onclick="openToolInfo('Source')"></div>
  <div class="hotspot-button" style="top: 24%; left: 63%; width: 5.5%; height: 5%;" onclick="openToolInfo('Event ID')"></div>
  <div class="hotspot-button" style="top: 24%; left: 69%; width: 9%; height: 5%;" onclick="openToolInfo('Task Category')"></div>
  <div class="hotspot-button" style="top: 68%; left: 22%; width: 11%; height: 5%;" onclick="openToolInfo('General/Details')"></div>
  <div class="hotspot-button" style="top: 18%; left: 81%; width: 17%; height: 78%;" onclick="openToolInfo('Actions')"></div>
</div>

  <!-- Info Panel & Overlay -->
  <div class="overlay" id="overlay" onclick="closePanel()"></div>
  <div class="info-panel" id="infoPanel">
    <span class="close-btn" onclick="closePanel()">×</span>
    <h3 id="panelTitle">Title</h3>
    <p id="panelContent">Information goes here...</p>
  </div>

  <!-- Bottom Right Next Button -->
  <a href="task_manager.html" class="corner-button next-button">Explore Task Manager →</a>
  <!-- Bottom Left Back Button -->
  <a href="home.html" class="corner-button back-button">← Go Back</a>

  <!-- Right-Side Instruction Panel -->
  <div class="instructions-panel" id="instructionsPanel">
    <div class="instructions-header">
      <h4>Instructions</h4>
      <button class="collapse-btn" onclick="toggleInstructions()">
        <i class="fas fa-chevron-right" id="collapseIcon"></i>
      </button>
    </div>
    <div class="instructions-content">
      <p>Welcome to the Event Viewer simulation!</p>
      <ul>
        <li>Hover over areas to find the 10 interactive hotspots.</li>
        <li>Click on them to learn more about cybersecurity tools.</li>
        <li>Once done, feel free to explore more tools by using the buttons near the bottom.</li>
      </ul>
      <hr>
      <p><strong>Tip:</strong></p>
      <p>Windows key + R, then type 'eventvwr' will open up event viewer for you!</p>
    </div>
  </div>

  <!-- Reopen Button (hidden until panel is collapsed) -->
  <button class="reopen-btn" id="reopenBtn" onclick="toggleInstructions()" style="display: none;">
    <i class="fas fa-chevron-left"></i> Instructions
  </button>

  <!-- Footer -->
  <footer class="footer mt-auto">
    <div>
      <p>© 2025 CyberSleuth Academy. Developed by TP Cybersecurity & Digital Forensics Students.</p>
      <p class="mb-0">All content is for educational purposes only.</p>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Core Script -->
  <script>
    const toolData = {
      "Application": "Take note of crashes especially if coming from an antivirus and also do check for PowerShell activity (Event ID 400, 403, 600).",
      "Security": "Logon events at unusual hours or accounts and failed logon events with a brute-force pattern(Event ID 4624, 4625) are red flags and should be looked into. Unauthorised account creation or special logons (Event IDs 4720, 4670, 4672) could be a sign of attempt of privilege escalation. Audit policy changes (Event ID 4719) are also something to look out for as attackers might wish to disable logging. Cleared logs (Event ID 1102) is a strong indicator of someone trying to hide their traces.",
      "System": "Look out for unexpected shutdowns or restarts (Event IDs 1074, 6008), services terminated or suspicious services installed (Event ID 7034, 7045) to see if you have been compromised.",
      "Keywords": "Remember that 'Audit Success' is not always good and 'Audit Failure' is not always bad! Some could be genuine mistakes so do look out for a pattern to see if they are suspicious or not. (Eg. A sudden successful logon event after multiple failures could indicate a successful password guess through brute-force method.)",
      "Date and Time": "Some typical things to look our for: FIRST know BAD event, CLUSTERING of events, activities at ODD HOURS, TIME GAPS between events. these can be useful to refer to when incidents have happened and would like to make a timeline of events to deduce what the process was like. Good to look for patterns as it can indicate malicious tasks being scheduled to keep malware persistent. While looking at the timeline and you notice the order of logs are looking off, it could indicate that it has been tampered with.",
      "Source": "Unfamiliar or misspelled sources should raise concerns, especially if there are multiple events from those same suspicious sources. New or unknown sources appearing only after suspected infection could indicate that the machine has been compromised.",
      "Event ID": "Unique ID that is assigned to a specific event. A good way to make use of this is to create filters to view Event IDs of a high-risk event to narrow down their search. Remember to always look at the 'Source' as well as the same Event ID number could appear across different sources and could mean different things!",
      "Task Category": "A sub-classification within a source to describe the nature of the event. Some common ones affected by malware can include: Account Lockout, Policy Change, Service Installed, Process Creation.",
      "General/Details": "The General tab shows a human readable summary of an event. It contains Event ID and keywords, the action that occured and key parameters. The Details tab shows raw XML or structured data for the event which can be useful as the information came straight from the Windows log, uneditted.",
      "Actions": "A range of actions available: open saved log, save all events as..., clear log, attatch task to this log, filter current log, find, refresh. many of these would come in handy, for example, we can export whatever present logs there are available before certain malware has been programmed to wipe the logs. or we can create custom alerts where we set an alert when a specific event happens."
    };

    function openToolInfo(toolName) {
      const panel = document.getElementById("infoPanel");
      const overlay = document.getElementById("overlay");
      document.getElementById("panelTitle").textContent = toolName;
      document.getElementById("panelContent").textContent = toolData[toolName] || "No information available.";
      panel.style.display = "block";
      overlay.style.display = "block";
    }

    function closePanel() {
      document.getElementById("infoPanel").style.display = "none";
      document.getElementById("overlay").style.display = "none";
    }


    
    function toggleInstructions() {
      const panel = document.getElementById('instructionsPanel');
      const reopenBtn = document.getElementById('reopenBtn');
      const icon = document.getElementById('collapseIcon');

      // Toggle collapsed class on panel
      panel.classList.toggle('collapsed');

      // If panel is collapsed
      if (panel.classList.contains('collapsed')) {
        reopenBtn.style.display = 'block';
      } else {
        reopenBtn.style.display = 'none';
      }

      // Toggle icon direction
      icon.classList.toggle('fa-chevron-right');
      icon.classList.toggle('fa-chevron-left');
    }
      
  </script>
</body>
</html>